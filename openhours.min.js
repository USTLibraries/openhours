/* ********************************************************************************************
    	Open Hours from Google Calendar - https://github.com/ustlibraries/openhours
   ********************************************************************************************/
!function(a){var b="0.1.2-20161115",c=!1,d="",e={},f="-06:00",h=function(a){if(!c){var b=new Date,d=b.getHours()+":"+b.getMinutes()+":"+b.getSeconds()+"."+b.getMilliseconds();console.log("OPENHOURS ["+d+"] : "+a)}},i=function(a){a?(h("Silenced"),c=!0):(c=!1,h("Unsilenced"))},j=function(a){e=a},k=function(a){d=a},l=function(a){f=a},m=function(){a("#openhours div[data-openhours-location]").each(function(){n(a(this))})},n=function(b){var c=a(b).attr("data-openhours-location");h("Getting hours for: "+c),a(b).html("-");var d=new Date,g=d.getMonth(),i=d.getDate(),j=d.getFullYear(),k=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],l=1;a(b).hasClass("dailyHours")&&(l=7);var m=gapi.client.calendar.events.list({calendarId:e[c],timeMin:new Date(j,g,i).toISOString(),showDeleted:!1,singleEvents:!0,maxResults:l,orderBy:"startTime"});m.execute(function(e){var g=e.items,i=document.createTextNode("No Hours Listed");if(a(b).html(""),g.length>0)for(var j=0;j<g.length;j++){var l=document.createElement("span"),m=g[j],n=m.start.dateTime,o=m.end.dateTime;n||(n=m.start.date+"T00:00:00"+f),o||(o=m.start.date+"T23:59:00"+f);var p=new Date(n),q=new Date(o);h(c+" Event: "+n+" - "+o);var r=k[p.getDay()]+" "+(p.getMonth()+1)+"/"+p.getDate();r+=p.getDate()===d.getDate()&&q.getTime()<d.getTime()?" - Closed for the day":" - "+m.summary,i=document.createTextNode(r),a(l).append(i),a(b).append(l)}else{var l=document.createElement("span");a(l).append(i),a(b).append(l)}})};a.fn.openhours=function(a,f){switch(a.toLowerCase()){case"load":h("Version: "+b),""!==d&&Object.keys(e).length>0?(gapi.client.setApiKey(d),gapi.client.load("calendar","v3").then(m)):(c=!1,h("Google Calendar API Key and Calendar(s) not set! Please read Open Hours doc for more information."));break;case"config":"undefined"!=typeof f.silence&&i(f.silence),"undefined"!=typeof f.calendar&&j(f.calendar),"undefined"!=typeof f.apiKey&&k(f.apiKey),"undefined"!=typeof f.timeOffset&&l(f.timeOffset);break;case"debug":"undefined"!=typeof f.message&&h(f.message);break;default:h("Unknown Command for openhours(): "+a)}}}(jQuery);var init_openhours=function(){$(document).openhours("debug",{message:"Load called"}),$("#openhours").openhours("load")};$(document).ready(function(){if($("#openhours").size()){$(document).openhours("debug",{message:"Placeholder for Open Hours Found"});var a=document.getElementsByTagName("script")[0],b=document.createElement("script");b.type="text/javascript",b.async=!0,b.src="https://apis.google.com/js/client.js?onload=init_openhours",a.parentNode.insertBefore(b,a)}});